# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript
# https://docs.microsoft.com/en-us/azure/devops/pipelines/agents/hosted?view=azure-devops&tabs=yaml

trigger:
  - master

pr:
  - master

pool:
  # https://github.com/actions/virtual-environments/blob/main/images/win/Windows2019-Readme.md
  vmImage: 'windows-2019'

steps:
  - bash: |
      yarn install --frozen-lockfile --ignore-optional
      yarn run build
    displayName: 'yarn install and build'

  - bash: npx webdriver-manager update --versions.standalone 3.141.59
    displayName: 'Update webdriver manager'

  - bash: echo "##vso[task.prependpath]$IEWebDriver;"
    displayName: 'Add IE driver executable to PATH'

  - script: yarn run test:ptor
    displayName: 'Protractor tests'

  - task: PublishPipelineArtifact@0
    condition: always()
    inputs:
      targetPath: test/protractor
      artifactName: snapshots
